l_z=[0,0.509,-0.0738,0.0267];
m_z=[1,-2.6472, 2.0564,-0.4966];

[A,B,C,D]=tf2ss(l_z, m_z);
A=A';
B1=B';
C1=C';
C=B1;
B=C1;
D=0;
m=zeros(1,12);
m2=zeros(1,12);
for t=1:100;
maximum=0;
clear u;
clear x1;
clear x2;
clear x3;
clear y;
z=t/80;
K=acker(A,B,[z z z]);
k_konc=100;
x1(1)=1; 
x2(1)=-1; 
x3(1)=3;
x1(k_konc)=0; 
x2(k_konc)=0; 
x3(k_konc)=0;
u(1)=-(K(1,1)*x1(1)+K(1,2)*x2(1)+K(1,3)*x3(1));
y(1)=C(1,1)*x1(1)+C(1,2)*x2(1)+C(1,3)*x3(1);  
for k=2:4;
     x1(k)=A(1,1)*x1(k-1)+A(1,2)*x2(k-1)+A(1,3)*x3(k-1)+B(1)*u(k-1);
     x2(k)=A(2,1)*x1(k-1)+A(2,2)*x2(k-1)+A(2,3)*x3(k-1)+B(2)*u(k-1);
     x3(k)=A(3,1)*x1(k-1)+A(3,2)*x2(k-1)+A(3,3)*x3(k-1)+B(3)*u(k-1);
     y(k)=C(1,1)*x1(k)+C(1,2)*x2(k)+C(1,3)*x3(k);
     u(k)=-(K(1,1)*x1(k)+K(1,2)*x2(k)+K(1,3)*x3(k));
     roznica(k) =u(k)- u(k-1); 
     if maximum<abs(roznica(k));
         maximum=abs(roznica(k));
     end;
end;
m(1,t)=maximum;
m2(1,t)=t/80;
end;
plot(m2, m, '--');
xlabel('Wartość biegunów');
ylabel('Maksymalny przyrost sterowania');

print('wykres_zad3','-dpng');